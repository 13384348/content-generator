# è¿ç»´æ‰‹å†Œ - AIå†…å®¹ç”ŸæˆåŠ©æ‰‹

## ğŸš¨ ç´§æ€¥æ•…éšœå¤„ç†

### ç½‘ç«™æ— æ³•è®¿é—® - å¿«é€Ÿæ¢å¤
å½“ http://8.154.36.16:5004 æ— æ³•è®¿é—®æ—¶ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

```bash
# 1. ç«‹å³é‡å¯æœåŠ¡å™¨ï¼ˆæ¨èæ–¹å¼ï¼‰
ssh root@8.154.36.16 "/opt/content-generator/server-daemon.sh"
```

å¦‚æœä¸Šè¿°å‘½ä»¤å¤±è´¥ï¼Œä½¿ç”¨æ‰‹åŠ¨æ–¹å¼ï¼š
```bash
# 2. æ‰‹åŠ¨æ¸…ç†å’Œé‡å¯
ssh root@8.154.36.16 "pkill -f 'node server.js' && cd /opt/content-generator/backend && nohup node server.js > /tmp/server.log 2>&1 &"
```

### å¸¸è§é”™è¯¯ä¿¡æ¯åŠè§£å†³æ–¹æ¡ˆ

#### é”™è¯¯1: ERR_CONNECTION_RESET
**ç—‡çŠ¶**: å‰ç«¯æ— æ³•è¿æ¥åç«¯API
**åŸå› **: å¤šä¸ªæœåŠ¡å™¨è¿›ç¨‹å†²çª
**è§£å†³**:
```bash
ssh root@8.154.36.16 "/opt/content-generator/server-daemon.sh"
```

#### é”™è¯¯2: userService is not defined
**ç—‡çŠ¶**: è®¤è¯ä¸­é—´ä»¶æŠ¥é”™
**åŸå› **: å˜é‡ä½œç”¨åŸŸé—®é¢˜
**è§£å†³**: å·²ä¿®å¤ï¼Œå¦‚æœå†æ¬¡å‡ºç°éœ€è¦æ›´æ–° `backend/middleware/auth.js`

#### é”™è¯¯3: ç«¯å£5004è¢«å ç”¨
**ç—‡çŠ¶**: æœåŠ¡å™¨å¯åŠ¨å¤±è´¥ï¼Œæç¤º EADDRINUSE
**åŸå› **: æ—§è¿›ç¨‹æœªæ­£ç¡®æ¸…ç†
**è§£å†³**:
```bash
ssh root@8.154.36.16 "pkill -f 'node server.js' && sleep 3"
ssh root@8.154.36.16 "/opt/content-generator/server-daemon.sh"
```

## ğŸ“Š æœåŠ¡å™¨ç›‘æ§

### æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€
```bash
# æ£€æŸ¥è¿›ç¨‹æ˜¯å¦è¿è¡Œ
ssh root@8.154.36.16 "ps -p \$(cat /tmp/content-generator.pid)"

# æ£€æŸ¥HTTPæœåŠ¡å“åº”
curl -s http://8.154.36.16:5004/api/about

# æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—
ssh root@8.154.36.16 "tail -20 /tmp/content-generator.log"
```

### æ€§èƒ½ç›‘æ§
```bash
# æŸ¥çœ‹æœåŠ¡å™¨èµ„æºä½¿ç”¨
ssh root@8.154.36.16 "top -p \$(cat /tmp/content-generator.pid)"

# æŸ¥çœ‹å†…å­˜ä½¿ç”¨
ssh root@8.154.36.16 "free -h"

# æŸ¥çœ‹ç£ç›˜ä½¿ç”¨
ssh root@8.154.36.16 "df -h"
```

## ğŸš€ éƒ¨ç½²æµç¨‹

### æ ‡å‡†éƒ¨ç½²æµç¨‹
1. **å‰ç«¯æ„å»º**
```bash
cd frontend
npm run build
```

2. **æ‰§è¡Œç¨³å®šéƒ¨ç½²è„šæœ¬**
```bash
./deploy-stable.sh
```

### ä»…æ›´æ–°å‰ç«¯
```bash
cd frontend
npm run build
scp -r dist/* root@8.154.36.16:/opt/content-generator/frontend/dist/
```

### ä»…æ›´æ–°åç«¯
```bash
scp backend/server.js root@8.154.36.16:/opt/content-generator/backend/
ssh root@8.154.36.16 "/opt/content-generator/server-daemon.sh"
```

### ç´§æ€¥å›æ»š
å¦‚æœéƒ¨ç½²å‡ºç°é—®é¢˜ï¼Œå¯ä»¥å¿«é€Ÿå›æ»šï¼š
```bash
# æ¢å¤ç¨³å®šç‰ˆæœ¬ï¼ˆéœ€è¦æå‰å¤‡ä»½ï¼‰
ssh root@8.154.36.16 "cp /opt/content-generator/backup/* /opt/content-generator/backend/"
ssh root@8.154.36.16 "/opt/content-generator/server-daemon.sh"
```

## ğŸ—„ï¸ æ•°æ®åº“ç»´æŠ¤

### æ•°æ®åº“å¤‡ä»½
```bash
# åˆ›å»ºæ•°æ®åº“å¤‡ä»½
ssh root@8.154.36.16 "cp /opt/content-generator/backend/content_generator.db /opt/content-generator/backup/db_backup_\$(date +%Y%m%d_%H%M%S).db"
```

### æ•°æ®åº“é‡ç½®ï¼ˆè°¨æ…æ“ä½œï¼‰
```bash
# é‡æ–°åˆå§‹åŒ–æ•°æ®åº“
ssh root@8.154.36.16 "cd /opt/content-generator/backend && node -e \"require('./database/init-safe.js').initDatabase()\""
```

### æŸ¥çœ‹æ•°æ®åº“çŠ¶æ€
```bash
ssh root@8.154.36.16 "ls -la /opt/content-generator/backend/*.db"
```

## ğŸ”§ é…ç½®ç®¡ç†

### ç¯å¢ƒå˜é‡
ä¸»è¦é…ç½®æ–‡ä»¶ä½ç½®ï¼š
- æœåŠ¡å™¨é…ç½®: `/opt/content-generator/backend/server.js`
- æ•°æ®åº“é…ç½®: `/opt/content-generator/backend/database/`

### é‡è¦é…ç½®é¡¹
- ç«¯å£å·: 5004
- æ•°æ®åº“æ–‡ä»¶: `content_generator.db`
- æ—¥å¿—æ–‡ä»¶: `/tmp/content-generator.log`
- PIDæ–‡ä»¶: `/tmp/content-generator.pid`

## ğŸ›¡ï¸ å®‰å…¨ç»´æŠ¤

### å®šæœŸå®‰å…¨æ£€æŸ¥
```bash
# æ£€æŸ¥å¼‚å¸¸ç™»å½•
ssh root@8.154.36.16 "last | head -20"

# æ£€æŸ¥ç³»ç»Ÿè´Ÿè½½
ssh root@8.154.36.16 "uptime"

# æ£€æŸ¥ç½‘ç»œè¿æ¥
ssh root@8.154.36.16 "netstat -tlnp | grep 5004"
```

### æ—¥å¿—åˆ†æ
```bash
# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
ssh root@8.154.36.16 "grep -i error /tmp/content-generator.log"

# æŸ¥çœ‹APIè°ƒç”¨é¢‘ç‡
ssh root@8.154.36.16 "grep -c 'APIè°ƒç”¨' /tmp/content-generator.log"
```

## ğŸ“‹ å®šæœŸç»´æŠ¤ä»»åŠ¡

### æ¯æ—¥æ£€æŸ¥æ¸…å•
- [ ] æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦æ­£å¸¸è¿è¡Œ
- [ ] æ£€æŸ¥æ—¥å¿—æ˜¯å¦æœ‰å¼‚å¸¸é”™è¯¯
- [ ] éªŒè¯ç½‘ç«™è®¿é—®æ˜¯å¦æ­£å¸¸
- [ ] æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶å¤§å°

### æ¯å‘¨ç»´æŠ¤ä»»åŠ¡
- [ ] åˆ›å»ºæ•°æ®åº“å¤‡ä»½
- [ ] æ¸…ç†æ—§æ—¥å¿—æ–‡ä»¶
- [ ] æ£€æŸ¥ç£ç›˜ç©ºé—´ä½¿ç”¨
- [ ] æ›´æ–°ç³»ç»Ÿè¡¥ä¸ï¼ˆå¦‚éœ€è¦ï¼‰

### æ¯æœˆç»´æŠ¤ä»»åŠ¡
- [ ] æ€§èƒ½åˆ†æå’Œä¼˜åŒ–
- [ ] ç”¨æˆ·æ•°æ®ç»Ÿè®¡
- [ ] æœåŠ¡å™¨èµ„æºè¯„ä¼°
- [ ] å®‰å…¨å®¡è®¡

## ğŸ“ ç´§æ€¥è”ç³»æ–¹å¼

### æŠ€æœ¯æ”¯æŒ
- **ä¸»è¦ç»´æŠ¤**: Claude Code Assistant
- **ä¸šåŠ¡è”ç³»**: å¹¿è¥¿è’™å¤ªå¥‡å½±è§†ä¼ åª’æœ‰é™å…¬å¸
- **è”ç³»ç”µè¯**: 13978445003
- **å¾®ä¿¡å·**: 13978445003

### æ•…éšœå‡çº§æµç¨‹
1. **Level 1**: ä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬å°è¯•ä¿®å¤
2. **Level 2**: æ‰‹åŠ¨è¯Šæ–­å’Œä¿®å¤
3. **Level 3**: è”ç³»æŠ€æœ¯æ”¯æŒ
4. **Level 4**: ä¸šåŠ¡æ–¹é€šçŸ¥å’Œåº”æ€¥æ–¹æ¡ˆ

## ğŸ”„ å¸¸ç”¨è¿ç»´è„šæœ¬

### æœåŠ¡å™¨å¥åº·æ£€æŸ¥è„šæœ¬
```bash
#!/bin/bash
# health-check.sh
echo "=== æœåŠ¡å™¨å¥åº·æ£€æŸ¥ ==="
ssh root@8.154.36.16 "
echo '1. è¿›ç¨‹çŠ¶æ€:'
ps -p \$(cat /tmp/content-generator.pid) || echo 'è¿›ç¨‹æœªè¿è¡Œ'

echo '2. HTTPå“åº”:'
curl -s --connect-timeout 5 http://localhost:5004/api/about > /dev/null && echo 'HTTPæœåŠ¡æ­£å¸¸' || echo 'HTTPæœåŠ¡å¼‚å¸¸'

echo '3. ç£ç›˜ä½¿ç”¨:'
df -h | grep -E '(Filesystem|/dev/)'

echo '4. å†…å­˜ä½¿ç”¨:'
free -h

echo '5. æœ€è¿‘é”™è¯¯:'
tail -5 /tmp/content-generator.log | grep -i error || echo 'æ— é”™è¯¯æ—¥å¿—'
"
```

### æ—¥å¿—æ¸…ç†è„šæœ¬
```bash
#!/bin/bash
# cleanup-logs.sh
ssh root@8.154.36.16 "
# ä¿ç•™æœ€è¿‘1000è¡Œæ—¥å¿—
tail -1000 /tmp/content-generator.log > /tmp/content-generator.log.tmp
mv /tmp/content-generator.log.tmp /tmp/content-generator.log
echo 'æ—¥å¿—æ¸…ç†å®Œæˆ'
"
```

---

**æœ€åæ›´æ–°**: 2025å¹´9æœˆ28æ—¥
**ç»´æŠ¤å›¢é˜Ÿ**: Claude Code Assistant + èŒå¤ªå¥‡æŠ€æœ¯å›¢é˜Ÿ